{% from "_formhelpers.html" import render_field %}


{% extends "base.html" %}
{% block content %}
   {% include "post_base.html" %}
   <div class="post-content">
       <strong>Post:</strong> {{ post.description }} <br>
       <br>
       <br>
   </div>
   <hr>
   <h3>Add comment:</h3>

    <form class="form-signin" action="" role="form" method="post">
        {{ form.csrf_token }}

        {{ render_field(field=form.content, placeholder="Content", class="form-control") }}

        <button class="btn btn-sm btn-success" type="submit">Add comment</button>
    </form>
    {% if error %}
    <strong>Error: </strong><div class="alert">{{ error}} </div>
    {% endif %}

   <hr>
   {% if not comments.first()  %} {# if post has no comments #}
   <i style = "color: #999"> No comments yet</i>
   {% else %}
   <h2>Comments({{ post.comments | count }}): </h2>
   <div class="comments">
       {% for comment in comments %}
       <div class="comment">
           <i>#{{ comment.id }}</i> 
            <span class="author"> 
            <a href="{{ url_for("users.posts_by_author", 
                       author=post.author.name)}}">
               {{ comment.author.name }} 
            </a>
            </span> 
               
           <p class="comment-body">{{ comment.content }}</p>
       </div>
       {% endfor %}
   </div>
   {% endif %}
{% endblock %} 
